description = "Analyzes oRPC contracts from a given path and generates TanStack Query wrappers."
prompt = """
You are an expert software developer specializing in TypeScript, oRPC, and TanStack Query.

Your task is to generate TanStack Query wrappers (`queryOptions` and `mutationOptions`) for the oRPC contract definitions found in the file(s) or directory specified by the user in the arguments: `{{args}}`

First, use the `read_many_files` tool to read the content of `{{args}}`.

Then, analyze the content and generate the query wrappers. The generated code should be placed in a new file. You should infer the correct output path (e.g., `src/queries/<subsystem>/<entity>.ts`) from the input path `{{args}}`.

Please follow the detailed instructions in the guide below to ensure your output is consistent with the project's coding standards.

# Guide: Creating TanStack Query Wrappers for oRPC

This guide explains the project's conventions for wrapping oRPC procedures with TanStack Query for both data fetching (queries) and data manipulation (mutations).

## 1. File Structure

- Create a new file under `src/queries/<subsystem>/<entity>.ts`. For example, for a new "shipments" entity in the "tms" subsystem, you would create `src/queries/tms/shipments.ts`.
- All exports from this file should be re-exported from the corresponding `index.ts` file (e.g., `src/queries/tms/index.ts`).

## 2. Creating Queries (`queryOptions`)

Queries are used for fetching data. We create exported functions that wrap `queryOptions`.

### Basic Query

This is for simple data retrieval.

**Example (`paginateProduct`):**
```typescript
import { queryOptions } from '@tanstack/react-query';
import { orpcClient } from '@/orpc/client';

export const paginateProduct = (
  options: Parameters<typeof orpcClient.crm.paginateProduct>[0],
) =>
  queryOptions({
    // Convention: ['<subsystem>.<entity>', options]
    queryKey: ['crm.products', options],
    // The function that calls the oRPC procedure
    queryFn: () => orpcClient.crm.paginateProduct(options),
    // Prevents the query from running if options are not provided
    enabled: !!options,
  });
```

### Query with Relational Data

For queries that need to fetch related data (e.g., fetching a case and its owner), use `async ({ client })` and `client.ensureQueryData`.

**Example (`paginateCase`):**
```typescript
import { queryOptions } from '@tanstack/react-query';
import { nonEmpty } from '@/lib/utils';
import { orpcClient } from '@/orpc/client';
import { inUser } from '../auth/user';
import { inContact } from './contacts';

export const paginateCase = (
  options: Parameters<typeof orpcClient.crm.paginateCase>[0],
) =>
  queryOptions({
    queryKey: ['crm.cases', options],
    queryFn: async ({ client }) => {
      // 1. Fetch the primary data
      const cases = await orpcClient.crm.paginateCase(options);

      // 2. Fetch related data using other queries
      const contacts = await client.ensureQueryData(
        inContact(cases.map((row) => row.contactId).filter(nonEmpty)),
      );
      const owners = await client.ensureQueryData(
        inUser(cases.map((row) => row.ownerId)),
      );

      // 3. Map the results to combine them
      return cases.map((row) => ({
        ...row,
        contact: contacts.find((subRow) => subRow.id === row.contactId),
        owner: owners.find((subRow) => subRow.id === row.ownerId)!,
      }));
    },
    enabled: !!options,
  });
```

## 3. Creating Mutations (`mutationOptions`)

Mutations are used for creating, updating, and deleting data. We create exported constants using `mutationOptions`.

**Example (`createCampaign`):**
```typescript
import { ORPCError, ORPCErrorCode } from '@orpc/client';
import { mutationOptions } from '@tanstack/react-query';
import { toast } from 'sonner';
import { orpcClient } from '@/orpc/client';

export const createCampaign = mutationOptions<
  // 1. Return type of the oRPC procedure
  Awaited<ReturnType<typeof orpcClient.crm.createCampaign>>,
  // 2. Standard error type
  ORPCError<ORPCErrorCode, any>,
  // 3. Parameters type of the oRPC procedure
  Parameters<typeof orpcClient.crm.createCampaign>[0]
>({
  mutationFn: (options) => orpcClient.crm.createCampaign(options),
  async onSuccess(data, _variables, _onMutateResult, context) {
    // A. Show a success notification
    toast.success(`Operation success`, {
      description: `Campaign: ${data.name} has been added successfully`,
    });
    // B. Invalidate queries to refetch data
    await context.client.invalidateQueries({ queryKey: ['crm.campaigns'] });
  },
  async onError(error, _variables, _onMutateResult, _context) {
    // C. Show an error notification
    toast.error('Operation failed', { description: error.message });
  },
});
```

## 4. Re-export

Finally, remember to export your new query and mutation objects from the subsystem's `index.ts` file.

**Example (`src/queries/crm/index.ts`):**
```typescript
export * from './attachments';
export * from './campaigns';
// Add your new entity here
// export * from './your-new-entity';
```
"""