enum TaskItemStatus {
	PENDING
	IN_PROGRESS
	COMPLETED
	SHORT_PICKED
	DAMAGED
	NOT_FOUND
}

type TaskItems {
	id: ID!
	task: Tasks!
	product: WmsProducts!
	batch: InventoryBatches
	sourceLocation: Locations
	destinationLocation: Locations
	quantityRequired: Int!
	quantityCompleted: Int!
	quantityRemaining: Int
	status: TaskItemStatus
	lotNumber: String
	serialNumbers: [String]
	expiryDate: String
	notes: String
	completedAt: String
	createdAt: Date
	updatedAt: Date
}

input CreateTaskItemInput {
	productId: ID!
	batchId: ID
	sourceLocationId: ID
	destinationLocationId: ID
	quantityRequired: Int! @constraint(min: 1)
	quantityCompleted: Int! @constraint(min: 0)
	status: TaskItemStatus
	lotNumber: String @constraint(minLength: 1)
	serialNumbers: [String!]!
	expiryDate: String @constraint(minLength: 1)
	notes: String @constraint(minLength: 1)
}

input UpdateTaskItemInput {
	sourceLocationId: ID
	destinationLocationId: ID
	quantityRequired: Int @constraint(min: 1)
	quantityCompleted: Int @constraint(min: 0)
	status: TaskItemStatus
	expiryDate: Date
	notes: String @constraint(minLength: 1)
	completedAt: String @constraint(minLength: 1)
}

extend type WmsMutation {
	addTaskItem(id: ID!, value: CreateTaskItemInput!): TaskItems!
	updateTaskItem(id: ID!, value: UpdateTaskItemInput): TaskItems!
	removeTaskItem(id: ID!): DeleteResult!
}

type WmsTaskItemStatusChangedEvent {
	id: ID!
	newStatus: TaskItemStatus!
	previousStatus: TaskItemStatus!
	taskId: ID!
}

type WmsTaskItemShortPickedEvent {
	taskItem: TaskItems!
	shortQuantity: Int!
}

extend type Subscription {
	taskItemCompleted: TaskItems!
	taskItemStatusChanged: WmsTaskItemStatusChangedEvent!
	taskItemShortPicked: WmsTaskItemShortPickedEvent!
	taskItemDamaged: TaskItems!
}
