enum ExpenseType {
	FUEL
	TOLLS
	MAINTENANCE
	PARKING
	MEALS
	ACCOMMODATION
}

enum Currency {
	USD
	EUR
	GBP
	CAD
	AUD
	JPY
	PHP
}

enum ExpenseStatus {
	PENDING
	APPROVED
	REJECTED
	REIMBURSED
}

type Expenses {
	id: ID!
	trip: Trips
	driver: Drivers
	type: ExpenseType
	amount: Float!
	currency: Currency
	receiptUrl: String
	fuelQuantity: Float
	odometerReading: Int
	status: ExpenseStatus
	description: String
	expenseDate: String
	createdAt: Date
	updatedAt: Date
}

extend type TmsQuery {
	expenses(
		page: Int
		perPage: Int
		from: Date
		to: Date
		search: String
		type: ExpenseType
		currency: Currency
		status: ExpenseStatus
	): [Expenses!]!
	expense(id: ID!): Expenses!
}

input CreateExpenseInput {
	tripId: ID
	driverId: ID
	type: ExpenseType
	amount: Float! @constraint(min: 0)
	currency: Currency
	receiptUrl: String @constraint(minLength: 1)
	fuelQuantity: Float @constraint(min: 0)
	odometerReading: Int @constraint(min: 0)
	status: ExpenseStatus
	description: String @constraint(minLength: 1)
	expenseDate: Date
}

input UpdateExpenseInput {
	type: ExpenseType
	amount: Float @constraint(min: 0)
	currency: Currency
	receiptUrl: String @constraint(minLength: 1)
	fuelQuantity: Float @constraint(min: 0)
	odometerReading: Int @constraint(min: 0)
	status: ExpenseStatus
	description: String @constraint(minLength: 1)
	expenseDate: Date
}

extend type TmsMutation {
	createExpense(value: CreateExpenseInput!): Expenses!
	updateExpense(id: ID!, value: UpdateExpenseInput): Expenses!
	removeExpense(id: ID!): DeleteResult!
}

type TmsExpenseStatusChangedEvent {
	id: ID!
	newStatus: ExpenseStatus!
	previousStatus: ExpenseStatus!
	driverId: ID
}

type TmsExpenseRejectedEvent {
	expense: Expenses!
	rejectionReason: String
}

extend type Subscription {
	expenseSubmitted: Expenses!
	expenseStatusChanged: TmsExpenseStatusChangedEvent!
	expenseApproved: Expenses!
	expenseRejected: TmsExpenseRejectedEvent!
}
