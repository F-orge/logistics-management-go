enum LeadSource {
  WEBSITE
  REFERRAL
  SOCIAL_MEDIA
  EMAIL_CAMPAIGN
  COLD_CALL
  EVENT
  ADVERTISMENT
  PARTNER
  OTHER
}

enum LeadStatus {
  NEW
  CONTACTED
  QUALIFIED
  UNQUALIFIED
  CONVERTED
}

type Leads {
  id: ID!
  name: String!
  email: String
  leadSource: LeadSource
  status: LeadStatus
  leadScore: Int
  owner: User
  campaign: Campaigns
  convertedAt: Date
  convertedContact: Contacts
  convertedCompany: Companies
  convertedOpportunity: Opportunities
  createdAt: Date
  updatedAt: Date
}

extend type CrmQuery {
  leads(page: Int, perPage: Int, from: Date, to: Date, search: String, leadSource: LeadSource, status: LeadStatus): [Leads!]!
  lead(id: ID!): Leads!
}

input CreateLeadInput {
  name: String! @constraint(minLength: 1)
  email: String! @constraint(format: "email")
  leadSource: LeadSource
  status: LeadStatus
  leadScore: Int @constraint(min: 0, max: 100)
  ownerId: ID!
  campaignId: ID
}

input UpdateLeadInput {
  name: String @constraint(minLength: 1)
  email: String @constraint(format: "email")
  leadSource: LeadSource
  status: LeadStatus
  leadScore: Int @constraint(min: 0, max: 100)
  convertedAt: Date
  convertedContactId: ID
  convertedCompanyId: ID
  convertedOpportunityId: ID
}

extend type CrmMutation {
  createLead(value: CreateLeadInput!): Leads!
  updateLead(id: ID!, value: UpdateLeadInput): Leads!
  removeLead(id: ID!): DeleteResult!
}

type CrmLeadStatusChangedEvent {
  id: ID!
  newStatus: LeadStatus!
  previousStatus: LeadStatus!
}

extend type Subscription {
  leadConverted: Leads!
  leadStatusChanged: CrmLeadStatusChangedEvent!
}
