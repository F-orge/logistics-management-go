enum OpportunityStage {
  PROSPECTING
  QUALIFICATION
  NEED_ANALYSIS
  DEMO
  PROPOSAL
  NEGOTIATION
  CLOSED_WON
  CLOSED_LOST
}

enum OpportunitySource {
  WEBSITE
  REFERRAL
  SOCIAL_MEDIA
  EMAIL_CAMPAIGN
  COLD_CALL
  EVENT
  ADVERTISMENT
  PARTNER
  EXISTING_CUSTOMER
  OTHER
}

type Opportunities {
  id: ID!
  name: String!
  stage: OpportunityStage
  dealValue: Float
  probability: Float
  expectedCloseDate: Date
  lostReason: String
  source: OpportunitySource
  owner: User
  contact: Contacts
  company: Companies
  campaign: Campaigns
  createdAt: Date
  updatedAt: Date
  products: [OpportunityProducts!]
  salesOrders: [SalesOrders!]
}

extend type CrmQuery {
  opportunities(page: Int, perPage: Int, from: Date, to: Date, search: String, stage: OpportunityStage, source: OpportunitySource): [Opportunities!]!
  opportunity(id: ID!): Opportunities!
}

input CreateOpportunityInput {
  name: String!
  stage: OpportunityStage!
  dealValue: Float
  probability: Float
  expectedCloseDate: Date
  lostReason: String
  source: OpportunitySource!
  ownerId: ID!
  contactId: ID
  companyId: ID
  campaignId: ID
  products: [CreateOpportunityProductInput!]!
}

input UpdateOpportunityInput {
  name: String
  stage: OpportunityStage
  dealValue: Float
  probability: Float
  expectedCloseDate: Date
  lostReason: String
  source: OpportunitySource
}

extend type CrmMutation {
  createOpportunity(value: CreateOpportunityInput!): Opportunities!
  updateOpportunity(id: ID!, value: UpdateOpportunityInput!): Opportunities!
}