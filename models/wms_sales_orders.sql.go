// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: wms_sales_orders.sql

package models

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const wmsAnySalesOrder = `-- name: WmsAnySalesOrder :many
select
  sales_orders.id, sales_orders.order_number, sales_orders.client_id, sales_orders.crm_opportunity_id, sales_orders.status, sales_orders.shipping_address, sales_orders.created_at, sales_orders.updated_at, sales_orders.sales_order_items,
  client.id, client.name, client.street, client.city, client.state, client.postal_code, client.country, client.phone_number, client.industry, client.website, client.annual_revenue, client.owner_id, client.created_at, client.updated_at,
  crm_opportunity.id, crm_opportunity.name, crm_opportunity.stage, crm_opportunity.deal_value, crm_opportunity.probability, crm_opportunity.expected_close_date, crm_opportunity.lost_reason, crm_opportunity.source, crm_opportunity.owner_id, crm_opportunity.contact_id, crm_opportunity.company_id, crm_opportunity.campaign_id, crm_opportunity.created_at, crm_opportunity.updated_at
from
  "wms"."sales_orders_view" as sales_orders
  inner join "crm"."companies" as client on sales_orders.client_id = client.id
  left join "crm"."opportunities" as crm_opportunity on sales_orders.crm_opportunity_id = crm_opportunity.id
where
  sales_orders.id = any ($1::uuid[])
`

type WmsAnySalesOrderRow struct {
	WmsSalesOrdersView WmsSalesOrdersView `db:"wms_sales_orders_view" json:"wms_sales_orders_view"`
	CrmCompany         CrmCompany         `db:"crm_company" json:"crm_company"`
	CrmOpportunity     CrmOpportunity     `db:"crm_opportunity" json:"crm_opportunity"`
}

func (q *Queries) WmsAnySalesOrder(ctx context.Context, ids []pgtype.UUID) ([]WmsAnySalesOrderRow, error) {
	rows, err := q.db.Query(ctx, wmsAnySalesOrder, ids)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []WmsAnySalesOrderRow
	for rows.Next() {
		var i WmsAnySalesOrderRow
		if err := rows.Scan(
			&i.WmsSalesOrdersView.ID,
			&i.WmsSalesOrdersView.OrderNumber,
			&i.WmsSalesOrdersView.ClientID,
			&i.WmsSalesOrdersView.CrmOpportunityID,
			&i.WmsSalesOrdersView.Status,
			&i.WmsSalesOrdersView.ShippingAddress,
			&i.WmsSalesOrdersView.CreatedAt,
			&i.WmsSalesOrdersView.UpdatedAt,
			&i.WmsSalesOrdersView.SalesOrderItems,
			&i.CrmCompany.ID,
			&i.CrmCompany.Name,
			&i.CrmCompany.Street,
			&i.CrmCompany.City,
			&i.CrmCompany.State,
			&i.CrmCompany.PostalCode,
			&i.CrmCompany.Country,
			&i.CrmCompany.PhoneNumber,
			&i.CrmCompany.Industry,
			&i.CrmCompany.Website,
			&i.CrmCompany.AnnualRevenue,
			&i.CrmCompany.OwnerID,
			&i.CrmCompany.CreatedAt,
			&i.CrmCompany.UpdatedAt,
			&i.CrmOpportunity.ID,
			&i.CrmOpportunity.Name,
			&i.CrmOpportunity.Stage,
			&i.CrmOpportunity.DealValue,
			&i.CrmOpportunity.Probability,
			&i.CrmOpportunity.ExpectedCloseDate,
			&i.CrmOpportunity.LostReason,
			&i.CrmOpportunity.Source,
			&i.CrmOpportunity.OwnerID,
			&i.CrmOpportunity.ContactID,
			&i.CrmOpportunity.CompanyID,
			&i.CrmOpportunity.CampaignID,
			&i.CrmOpportunity.CreatedAt,
			&i.CrmOpportunity.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const wmsFindSalesOrder = `-- name: WmsFindSalesOrder :one
select
  sales_orders.id, sales_orders.order_number, sales_orders.client_id, sales_orders.crm_opportunity_id, sales_orders.status, sales_orders.shipping_address, sales_orders.created_at, sales_orders.updated_at, sales_orders.sales_order_items,
  client.id, client.name, client.street, client.city, client.state, client.postal_code, client.country, client.phone_number, client.industry, client.website, client.annual_revenue, client.owner_id, client.created_at, client.updated_at,
  crm_opportunity.id, crm_opportunity.name, crm_opportunity.stage, crm_opportunity.deal_value, crm_opportunity.probability, crm_opportunity.expected_close_date, crm_opportunity.lost_reason, crm_opportunity.source, crm_opportunity.owner_id, crm_opportunity.contact_id, crm_opportunity.company_id, crm_opportunity.campaign_id, crm_opportunity.created_at, crm_opportunity.updated_at
from
  "wms"."sales_orders_view" as sales_orders
  inner join "crm"."companies" as client on sales_orders.client_id = client.id
  left join "crm"."opportunities" as crm_opportunity on sales_orders.crm_opportunity_id = crm_opportunity.id
where
  sales_orders.id = $1::uuid
`

type WmsFindSalesOrderRow struct {
	WmsSalesOrdersView WmsSalesOrdersView `db:"wms_sales_orders_view" json:"wms_sales_orders_view"`
	CrmCompany         CrmCompany         `db:"crm_company" json:"crm_company"`
	CrmOpportunity     CrmOpportunity     `db:"crm_opportunity" json:"crm_opportunity"`
}

func (q *Queries) WmsFindSalesOrder(ctx context.Context, id pgtype.UUID) (WmsFindSalesOrderRow, error) {
	row := q.db.QueryRow(ctx, wmsFindSalesOrder, id)
	var i WmsFindSalesOrderRow
	err := row.Scan(
		&i.WmsSalesOrdersView.ID,
		&i.WmsSalesOrdersView.OrderNumber,
		&i.WmsSalesOrdersView.ClientID,
		&i.WmsSalesOrdersView.CrmOpportunityID,
		&i.WmsSalesOrdersView.Status,
		&i.WmsSalesOrdersView.ShippingAddress,
		&i.WmsSalesOrdersView.CreatedAt,
		&i.WmsSalesOrdersView.UpdatedAt,
		&i.WmsSalesOrdersView.SalesOrderItems,
		&i.CrmCompany.ID,
		&i.CrmCompany.Name,
		&i.CrmCompany.Street,
		&i.CrmCompany.City,
		&i.CrmCompany.State,
		&i.CrmCompany.PostalCode,
		&i.CrmCompany.Country,
		&i.CrmCompany.PhoneNumber,
		&i.CrmCompany.Industry,
		&i.CrmCompany.Website,
		&i.CrmCompany.AnnualRevenue,
		&i.CrmCompany.OwnerID,
		&i.CrmCompany.CreatedAt,
		&i.CrmCompany.UpdatedAt,
		&i.CrmOpportunity.ID,
		&i.CrmOpportunity.Name,
		&i.CrmOpportunity.Stage,
		&i.CrmOpportunity.DealValue,
		&i.CrmOpportunity.Probability,
		&i.CrmOpportunity.ExpectedCloseDate,
		&i.CrmOpportunity.LostReason,
		&i.CrmOpportunity.Source,
		&i.CrmOpportunity.OwnerID,
		&i.CrmOpportunity.ContactID,
		&i.CrmOpportunity.CompanyID,
		&i.CrmOpportunity.CampaignID,
		&i.CrmOpportunity.CreatedAt,
		&i.CrmOpportunity.UpdatedAt,
	)
	return i, err
}

const wmsInsertSalesOrder = `-- name: WmsInsertSalesOrder :one
insert into "wms"."sales_orders"(order_number, client_id, crm_opportunity_id, status, shipping_address)
  values ($1, $2, $3, $4, $5)
returning
  id, order_number, client_id, crm_opportunity_id, status, shipping_address, created_at, updated_at
`

type WmsInsertSalesOrderParams struct {
	OrderNumber      string                      `db:"order_number" json:"order_number"`
	ClientID         pgtype.UUID                 `db:"client_id" json:"client_id"`
	CrmOpportunityID pgtype.UUID                 `db:"crm_opportunity_id" json:"crm_opportunity_id"`
	Status           NullWmsSalesOrderStatusEnum `db:"status" json:"status"`
	ShippingAddress  pgtype.Text                 `db:"shipping_address" json:"shipping_address"`
}

func (q *Queries) WmsInsertSalesOrder(ctx context.Context, arg WmsInsertSalesOrderParams) (WmsSalesOrder, error) {
	row := q.db.QueryRow(ctx, wmsInsertSalesOrder,
		arg.OrderNumber,
		arg.ClientID,
		arg.CrmOpportunityID,
		arg.Status,
		arg.ShippingAddress,
	)
	var i WmsSalesOrder
	err := row.Scan(
		&i.ID,
		&i.OrderNumber,
		&i.ClientID,
		&i.CrmOpportunityID,
		&i.Status,
		&i.ShippingAddress,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const wmsPaginateSalesOrder = `-- name: WmsPaginateSalesOrder :many
select
  sales_orders.id, sales_orders.order_number, sales_orders.client_id, sales_orders.crm_opportunity_id, sales_orders.status, sales_orders.shipping_address, sales_orders.created_at, sales_orders.updated_at, sales_orders.sales_order_items,
  client.id, client.name, client.street, client.city, client.state, client.postal_code, client.country, client.phone_number, client.industry, client.website, client.annual_revenue, client.owner_id, client.created_at, client.updated_at,
  crm_opportunity.id, crm_opportunity.name, crm_opportunity.stage, crm_opportunity.deal_value, crm_opportunity.probability, crm_opportunity.expected_close_date, crm_opportunity.lost_reason, crm_opportunity.source, crm_opportunity.owner_id, crm_opportunity.contact_id, crm_opportunity.company_id, crm_opportunity.campaign_id, crm_opportunity.created_at, crm_opportunity.updated_at
from
  "wms"."sales_orders_view" as sales_orders
  inner join "crm"."companies" as client on sales_orders.client_id = client.id
  left join "crm"."opportunities" as crm_opportunity on sales_orders.crm_opportunity_id = crm_opportunity.id
where (sales_orders.order_number ilike $1::text
  or client.name ilike $1::text
  or crm_opportunity.name ilike $1::text
  or sales_orders.status::text ilike $1::text
  or $1::text is null)
limit $3::int offset ($2::int - 1) * $3::int
`

type WmsPaginateSalesOrderParams struct {
	Search  pgtype.Text `db:"search" json:"search"`
	Page    int32       `db:"page" json:"page"`
	Perpage int32       `db:"perpage" json:"perpage"`
}

type WmsPaginateSalesOrderRow struct {
	WmsSalesOrdersView WmsSalesOrdersView `db:"wms_sales_orders_view" json:"wms_sales_orders_view"`
	CrmCompany         CrmCompany         `db:"crm_company" json:"crm_company"`
	CrmOpportunity     CrmOpportunity     `db:"crm_opportunity" json:"crm_opportunity"`
}

func (q *Queries) WmsPaginateSalesOrder(ctx context.Context, arg WmsPaginateSalesOrderParams) ([]WmsPaginateSalesOrderRow, error) {
	rows, err := q.db.Query(ctx, wmsPaginateSalesOrder, arg.Search, arg.Page, arg.Perpage)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []WmsPaginateSalesOrderRow
	for rows.Next() {
		var i WmsPaginateSalesOrderRow
		if err := rows.Scan(
			&i.WmsSalesOrdersView.ID,
			&i.WmsSalesOrdersView.OrderNumber,
			&i.WmsSalesOrdersView.ClientID,
			&i.WmsSalesOrdersView.CrmOpportunityID,
			&i.WmsSalesOrdersView.Status,
			&i.WmsSalesOrdersView.ShippingAddress,
			&i.WmsSalesOrdersView.CreatedAt,
			&i.WmsSalesOrdersView.UpdatedAt,
			&i.WmsSalesOrdersView.SalesOrderItems,
			&i.CrmCompany.ID,
			&i.CrmCompany.Name,
			&i.CrmCompany.Street,
			&i.CrmCompany.City,
			&i.CrmCompany.State,
			&i.CrmCompany.PostalCode,
			&i.CrmCompany.Country,
			&i.CrmCompany.PhoneNumber,
			&i.CrmCompany.Industry,
			&i.CrmCompany.Website,
			&i.CrmCompany.AnnualRevenue,
			&i.CrmCompany.OwnerID,
			&i.CrmCompany.CreatedAt,
			&i.CrmCompany.UpdatedAt,
			&i.CrmOpportunity.ID,
			&i.CrmOpportunity.Name,
			&i.CrmOpportunity.Stage,
			&i.CrmOpportunity.DealValue,
			&i.CrmOpportunity.Probability,
			&i.CrmOpportunity.ExpectedCloseDate,
			&i.CrmOpportunity.LostReason,
			&i.CrmOpportunity.Source,
			&i.CrmOpportunity.OwnerID,
			&i.CrmOpportunity.ContactID,
			&i.CrmOpportunity.CompanyID,
			&i.CrmOpportunity.CampaignID,
			&i.CrmOpportunity.CreatedAt,
			&i.CrmOpportunity.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const wmsRangeSalesOrder = `-- name: WmsRangeSalesOrder :many
select
  sales_orders.id, sales_orders.order_number, sales_orders.client_id, sales_orders.crm_opportunity_id, sales_orders.status, sales_orders.shipping_address, sales_orders.created_at, sales_orders.updated_at, sales_orders.sales_order_items,
  client.id, client.name, client.street, client.city, client.state, client.postal_code, client.country, client.phone_number, client.industry, client.website, client.annual_revenue, client.owner_id, client.created_at, client.updated_at,
  crm_opportunity.id, crm_opportunity.name, crm_opportunity.stage, crm_opportunity.deal_value, crm_opportunity.probability, crm_opportunity.expected_close_date, crm_opportunity.lost_reason, crm_opportunity.source, crm_opportunity.owner_id, crm_opportunity.contact_id, crm_opportunity.company_id, crm_opportunity.campaign_id, crm_opportunity.created_at, crm_opportunity.updated_at
from
  "wms"."sales_orders_view" as sales_orders
  inner join "crm"."companies" as client on sales_orders.client_id = client.id
  left join "crm"."opportunities" as crm_opportunity on sales_orders.crm_opportunity_id = crm_opportunity.id
where
  sales_orders.created_at >= $1::date
  and sales_orders.created_at <= $2::date
  and (sales_orders.order_number ilike $3::text
    or client.name ilike $3::text
    or crm_opportunity.name ilike $3::text
    or sales_orders.status::text ilike $3::text
    or $3::text is null)
`

type WmsRangeSalesOrderParams struct {
	Datefrom pgtype.Date `db:"datefrom" json:"datefrom"`
	Dateto   pgtype.Date `db:"dateto" json:"dateto"`
	Search   pgtype.Text `db:"search" json:"search"`
}

type WmsRangeSalesOrderRow struct {
	WmsSalesOrdersView WmsSalesOrdersView `db:"wms_sales_orders_view" json:"wms_sales_orders_view"`
	CrmCompany         CrmCompany         `db:"crm_company" json:"crm_company"`
	CrmOpportunity     CrmOpportunity     `db:"crm_opportunity" json:"crm_opportunity"`
}

func (q *Queries) WmsRangeSalesOrder(ctx context.Context, arg WmsRangeSalesOrderParams) ([]WmsRangeSalesOrderRow, error) {
	rows, err := q.db.Query(ctx, wmsRangeSalesOrder, arg.Datefrom, arg.Dateto, arg.Search)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []WmsRangeSalesOrderRow
	for rows.Next() {
		var i WmsRangeSalesOrderRow
		if err := rows.Scan(
			&i.WmsSalesOrdersView.ID,
			&i.WmsSalesOrdersView.OrderNumber,
			&i.WmsSalesOrdersView.ClientID,
			&i.WmsSalesOrdersView.CrmOpportunityID,
			&i.WmsSalesOrdersView.Status,
			&i.WmsSalesOrdersView.ShippingAddress,
			&i.WmsSalesOrdersView.CreatedAt,
			&i.WmsSalesOrdersView.UpdatedAt,
			&i.WmsSalesOrdersView.SalesOrderItems,
			&i.CrmCompany.ID,
			&i.CrmCompany.Name,
			&i.CrmCompany.Street,
			&i.CrmCompany.City,
			&i.CrmCompany.State,
			&i.CrmCompany.PostalCode,
			&i.CrmCompany.Country,
			&i.CrmCompany.PhoneNumber,
			&i.CrmCompany.Industry,
			&i.CrmCompany.Website,
			&i.CrmCompany.AnnualRevenue,
			&i.CrmCompany.OwnerID,
			&i.CrmCompany.CreatedAt,
			&i.CrmCompany.UpdatedAt,
			&i.CrmOpportunity.ID,
			&i.CrmOpportunity.Name,
			&i.CrmOpportunity.Stage,
			&i.CrmOpportunity.DealValue,
			&i.CrmOpportunity.Probability,
			&i.CrmOpportunity.ExpectedCloseDate,
			&i.CrmOpportunity.LostReason,
			&i.CrmOpportunity.Source,
			&i.CrmOpportunity.OwnerID,
			&i.CrmOpportunity.ContactID,
			&i.CrmOpportunity.CompanyID,
			&i.CrmOpportunity.CampaignID,
			&i.CrmOpportunity.CreatedAt,
			&i.CrmOpportunity.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const wmsRemoveSalesOrder = `-- name: WmsRemoveSalesOrder :exec
delete from "wms"."sales_orders"
where id = $1::uuid
`

func (q *Queries) WmsRemoveSalesOrder(ctx context.Context, id pgtype.UUID) error {
	_, err := q.db.Exec(ctx, wmsRemoveSalesOrder, id)
	return err
}

const wmsUpdateSalesOrder = `-- name: WmsUpdateSalesOrder :one
update
  "wms"."sales_orders"
set
  updated_at = now(),
  order_number = case when $1 is not null then
    $1::varchar
  else
    order_number
  end,
  client_id = case when $2 is not null then
    $2::uuid
  else
    client_id
  end,
  crm_opportunity_id = case when $3 is not null then
    $3::uuid
  else
    crm_opportunity_id
  end,
  status = case when $4 is not null then
    $4::wms.sales_order_status_enum
  else
    status
  end,
  shipping_address = case when $5 is not null then
    $5::text
  else
    shipping_address
  end
where
  id = $6::uuid
returning
  id, order_number, client_id, crm_opportunity_id, status, shipping_address, created_at, updated_at
`

type WmsUpdateSalesOrderParams struct {
	OrderNumber      string                      `db:"order_number" json:"order_number"`
	ClientID         pgtype.UUID                 `db:"client_id" json:"client_id"`
	CrmOpportunityID pgtype.UUID                 `db:"crm_opportunity_id" json:"crm_opportunity_id"`
	Status           NullWmsSalesOrderStatusEnum `db:"status" json:"status"`
	ShippingAddress  pgtype.Text                 `db:"shipping_address" json:"shipping_address"`
	ID               pgtype.UUID                 `db:"id" json:"id"`
}

func (q *Queries) WmsUpdateSalesOrder(ctx context.Context, arg WmsUpdateSalesOrderParams) (WmsSalesOrder, error) {
	row := q.db.QueryRow(ctx, wmsUpdateSalesOrder,
		arg.OrderNumber,
		arg.ClientID,
		arg.CrmOpportunityID,
		arg.Status,
		arg.ShippingAddress,
		arg.ID,
	)
	var i WmsSalesOrder
	err := row.Scan(
		&i.ID,
		&i.OrderNumber,
		&i.ClientID,
		&i.CrmOpportunityID,
		&i.Status,
		&i.ShippingAddress,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}
