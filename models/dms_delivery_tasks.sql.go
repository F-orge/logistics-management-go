// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: dms_delivery_tasks.sql

package models

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const dmsAnyDeliveryTask = `-- name: DmsAnyDeliveryTask :many
select
  delivery_tasks.id, delivery_tasks.package_id, delivery_tasks.delivery_route_id, delivery_tasks.route_sequence, delivery_tasks.delivery_address, delivery_tasks.recipient_name, delivery_tasks.recipient_phone, delivery_tasks.delivery_instructions, delivery_tasks.estimated_arrival_time, delivery_tasks.actual_arrival_time, delivery_tasks.delivery_time, delivery_tasks.status, delivery_tasks.failure_reason, delivery_tasks.attempt_count, delivery_tasks.created_at, delivery_tasks.updated_at,
  delivery_route.id, delivery_route.driver_id, delivery_route.route_date, delivery_route.status, delivery_route.optimized_route_data, delivery_route.total_distance_km, delivery_route.estimated_duration_minutes, delivery_route.actual_duration_minutes, delivery_route.started_at, delivery_route.completed_at, delivery_route.created_at, delivery_route.updated_at
from
  "dms"."delivery_tasks" as delivery_tasks
  inner join "dms"."delivery_routes" as delivery_route on delivery_tasks.delivery_route_id = delivery_route.id
where
  delivery_tasks.id = any ($1::uuid[])
`

type DmsAnyDeliveryTaskRow struct {
	DmsDeliveryTask  DmsDeliveryTask
	DmsDeliveryRoute DmsDeliveryRoute
}

func (q *Queries) DmsAnyDeliveryTask(ctx context.Context, ids []pgtype.UUID) ([]DmsAnyDeliveryTaskRow, error) {
	rows, err := q.db.Query(ctx, dmsAnyDeliveryTask, ids)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []DmsAnyDeliveryTaskRow
	for rows.Next() {
		var i DmsAnyDeliveryTaskRow
		if err := rows.Scan(
			&i.DmsDeliveryTask.ID,
			&i.DmsDeliveryTask.PackageID,
			&i.DmsDeliveryTask.DeliveryRouteID,
			&i.DmsDeliveryTask.RouteSequence,
			&i.DmsDeliveryTask.DeliveryAddress,
			&i.DmsDeliveryTask.RecipientName,
			&i.DmsDeliveryTask.RecipientPhone,
			&i.DmsDeliveryTask.DeliveryInstructions,
			&i.DmsDeliveryTask.EstimatedArrivalTime,
			&i.DmsDeliveryTask.ActualArrivalTime,
			&i.DmsDeliveryTask.DeliveryTime,
			&i.DmsDeliveryTask.Status,
			&i.DmsDeliveryTask.FailureReason,
			&i.DmsDeliveryTask.AttemptCount,
			&i.DmsDeliveryTask.CreatedAt,
			&i.DmsDeliveryTask.UpdatedAt,
			&i.DmsDeliveryRoute.ID,
			&i.DmsDeliveryRoute.DriverID,
			&i.DmsDeliveryRoute.RouteDate,
			&i.DmsDeliveryRoute.Status,
			&i.DmsDeliveryRoute.OptimizedRouteData,
			&i.DmsDeliveryRoute.TotalDistanceKm,
			&i.DmsDeliveryRoute.EstimatedDurationMinutes,
			&i.DmsDeliveryRoute.ActualDurationMinutes,
			&i.DmsDeliveryRoute.StartedAt,
			&i.DmsDeliveryRoute.CompletedAt,
			&i.DmsDeliveryRoute.CreatedAt,
			&i.DmsDeliveryRoute.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const dmsFindDeliveryTask = `-- name: DmsFindDeliveryTask :one
select
  delivery_tasks.id, delivery_tasks.package_id, delivery_tasks.delivery_route_id, delivery_tasks.route_sequence, delivery_tasks.delivery_address, delivery_tasks.recipient_name, delivery_tasks.recipient_phone, delivery_tasks.delivery_instructions, delivery_tasks.estimated_arrival_time, delivery_tasks.actual_arrival_time, delivery_tasks.delivery_time, delivery_tasks.status, delivery_tasks.failure_reason, delivery_tasks.attempt_count, delivery_tasks.created_at, delivery_tasks.updated_at,
  delivery_route.id, delivery_route.driver_id, delivery_route.route_date, delivery_route.status, delivery_route.optimized_route_data, delivery_route.total_distance_km, delivery_route.estimated_duration_minutes, delivery_route.actual_duration_minutes, delivery_route.started_at, delivery_route.completed_at, delivery_route.created_at, delivery_route.updated_at
from
  "dms"."delivery_tasks" as delivery_tasks
  inner join "dms"."delivery_routes" as delivery_route on delivery_tasks.delivery_route_id = delivery_route.id
where
  delivery_tasks.id = $1::uuid
`

type DmsFindDeliveryTaskRow struct {
	DmsDeliveryTask  DmsDeliveryTask
	DmsDeliveryRoute DmsDeliveryRoute
}

func (q *Queries) DmsFindDeliveryTask(ctx context.Context, id pgtype.UUID) (DmsFindDeliveryTaskRow, error) {
	row := q.db.QueryRow(ctx, dmsFindDeliveryTask, id)
	var i DmsFindDeliveryTaskRow
	err := row.Scan(
		&i.DmsDeliveryTask.ID,
		&i.DmsDeliveryTask.PackageID,
		&i.DmsDeliveryTask.DeliveryRouteID,
		&i.DmsDeliveryTask.RouteSequence,
		&i.DmsDeliveryTask.DeliveryAddress,
		&i.DmsDeliveryTask.RecipientName,
		&i.DmsDeliveryTask.RecipientPhone,
		&i.DmsDeliveryTask.DeliveryInstructions,
		&i.DmsDeliveryTask.EstimatedArrivalTime,
		&i.DmsDeliveryTask.ActualArrivalTime,
		&i.DmsDeliveryTask.DeliveryTime,
		&i.DmsDeliveryTask.Status,
		&i.DmsDeliveryTask.FailureReason,
		&i.DmsDeliveryTask.AttemptCount,
		&i.DmsDeliveryTask.CreatedAt,
		&i.DmsDeliveryTask.UpdatedAt,
		&i.DmsDeliveryRoute.ID,
		&i.DmsDeliveryRoute.DriverID,
		&i.DmsDeliveryRoute.RouteDate,
		&i.DmsDeliveryRoute.Status,
		&i.DmsDeliveryRoute.OptimizedRouteData,
		&i.DmsDeliveryRoute.TotalDistanceKm,
		&i.DmsDeliveryRoute.EstimatedDurationMinutes,
		&i.DmsDeliveryRoute.ActualDurationMinutes,
		&i.DmsDeliveryRoute.StartedAt,
		&i.DmsDeliveryRoute.CompletedAt,
		&i.DmsDeliveryRoute.CreatedAt,
		&i.DmsDeliveryRoute.UpdatedAt,
	)
	return i, err
}

const dmsInsertDeliveryTask = `-- name: DmsInsertDeliveryTask :one
insert into "dms"."delivery_tasks"(package_id, delivery_route_id, route_sequence, delivery_address, recipient_name, recipient_phone, delivery_instructions, estimated_arrival_time, actual_arrival_time, delivery_time, status, failure_reason, attempt_count)
  values ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13)
returning
  id, package_id, delivery_route_id, route_sequence, delivery_address, recipient_name, recipient_phone, delivery_instructions, estimated_arrival_time, actual_arrival_time, delivery_time, status, failure_reason, attempt_count, created_at, updated_at
`

type DmsInsertDeliveryTaskParams struct {
	PackageID            pgtype.UUID
	DeliveryRouteID      pgtype.UUID
	RouteSequence        int32
	DeliveryAddress      string
	RecipientName        pgtype.Text
	RecipientPhone       pgtype.Text
	DeliveryInstructions pgtype.Text
	EstimatedArrivalTime pgtype.Timestamp
	ActualArrivalTime    pgtype.Timestamp
	DeliveryTime         pgtype.Timestamp
	Status               NullDmsDeliveryTaskStatusEnum
	FailureReason        NullDmsDeliveryFailureReasonEnum
	AttemptCount         pgtype.Int4
}

func (q *Queries) DmsInsertDeliveryTask(ctx context.Context, arg DmsInsertDeliveryTaskParams) (DmsDeliveryTask, error) {
	row := q.db.QueryRow(ctx, dmsInsertDeliveryTask,
		arg.PackageID,
		arg.DeliveryRouteID,
		arg.RouteSequence,
		arg.DeliveryAddress,
		arg.RecipientName,
		arg.RecipientPhone,
		arg.DeliveryInstructions,
		arg.EstimatedArrivalTime,
		arg.ActualArrivalTime,
		arg.DeliveryTime,
		arg.Status,
		arg.FailureReason,
		arg.AttemptCount,
	)
	var i DmsDeliveryTask
	err := row.Scan(
		&i.ID,
		&i.PackageID,
		&i.DeliveryRouteID,
		&i.RouteSequence,
		&i.DeliveryAddress,
		&i.RecipientName,
		&i.RecipientPhone,
		&i.DeliveryInstructions,
		&i.EstimatedArrivalTime,
		&i.ActualArrivalTime,
		&i.DeliveryTime,
		&i.Status,
		&i.FailureReason,
		&i.AttemptCount,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const dmsPaginateDeliveryTask = `-- name: DmsPaginateDeliveryTask :many
select
  delivery_tasks.id, delivery_tasks.package_id, delivery_tasks.delivery_route_id, delivery_tasks.route_sequence, delivery_tasks.delivery_address, delivery_tasks.recipient_name, delivery_tasks.recipient_phone, delivery_tasks.delivery_instructions, delivery_tasks.estimated_arrival_time, delivery_tasks.actual_arrival_time, delivery_tasks.delivery_time, delivery_tasks.status, delivery_tasks.failure_reason, delivery_tasks.attempt_count, delivery_tasks.created_at, delivery_tasks.updated_at,
  delivery_route.id, delivery_route.driver_id, delivery_route.route_date, delivery_route.status, delivery_route.optimized_route_data, delivery_route.total_distance_km, delivery_route.estimated_duration_minutes, delivery_route.actual_duration_minutes, delivery_route.started_at, delivery_route.completed_at, delivery_route.created_at, delivery_route.updated_at
from
  "dms"."delivery_tasks" as delivery_tasks
  inner join "dms"."delivery_routes" as delivery_route on delivery_tasks.delivery_route_id = delivery_route.id
  -- Assuming wms.packages is in a different schema and cannot be joined directly for sqlc.embed
where
  (delivery_tasks.recipient_name ilike $1::text
  or delivery_tasks.delivery_address ilike $1::text
  or delivery_tasks.status::text ilike $1::text
  or delivery_route.status::text ilike $1::text
  or $1::text is null)
limit $3::int offset ($2::int - 1) * $3::int
`

type DmsPaginateDeliveryTaskParams struct {
	Search  pgtype.Text
	Page    int32
	Perpage int32
}

type DmsPaginateDeliveryTaskRow struct {
	DmsDeliveryTask  DmsDeliveryTask
	DmsDeliveryRoute DmsDeliveryRoute
}

func (q *Queries) DmsPaginateDeliveryTask(ctx context.Context, arg DmsPaginateDeliveryTaskParams) ([]DmsPaginateDeliveryTaskRow, error) {
	rows, err := q.db.Query(ctx, dmsPaginateDeliveryTask, arg.Search, arg.Page, arg.Perpage)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []DmsPaginateDeliveryTaskRow
	for rows.Next() {
		var i DmsPaginateDeliveryTaskRow
		if err := rows.Scan(
			&i.DmsDeliveryTask.ID,
			&i.DmsDeliveryTask.PackageID,
			&i.DmsDeliveryTask.DeliveryRouteID,
			&i.DmsDeliveryTask.RouteSequence,
			&i.DmsDeliveryTask.DeliveryAddress,
			&i.DmsDeliveryTask.RecipientName,
			&i.DmsDeliveryTask.RecipientPhone,
			&i.DmsDeliveryTask.DeliveryInstructions,
			&i.DmsDeliveryTask.EstimatedArrivalTime,
			&i.DmsDeliveryTask.ActualArrivalTime,
			&i.DmsDeliveryTask.DeliveryTime,
			&i.DmsDeliveryTask.Status,
			&i.DmsDeliveryTask.FailureReason,
			&i.DmsDeliveryTask.AttemptCount,
			&i.DmsDeliveryTask.CreatedAt,
			&i.DmsDeliveryTask.UpdatedAt,
			&i.DmsDeliveryRoute.ID,
			&i.DmsDeliveryRoute.DriverID,
			&i.DmsDeliveryRoute.RouteDate,
			&i.DmsDeliveryRoute.Status,
			&i.DmsDeliveryRoute.OptimizedRouteData,
			&i.DmsDeliveryRoute.TotalDistanceKm,
			&i.DmsDeliveryRoute.EstimatedDurationMinutes,
			&i.DmsDeliveryRoute.ActualDurationMinutes,
			&i.DmsDeliveryRoute.StartedAt,
			&i.DmsDeliveryRoute.CompletedAt,
			&i.DmsDeliveryRoute.CreatedAt,
			&i.DmsDeliveryRoute.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const dmsRangeDeliveryTask = `-- name: DmsRangeDeliveryTask :many
select
  delivery_tasks.id, delivery_tasks.package_id, delivery_tasks.delivery_route_id, delivery_tasks.route_sequence, delivery_tasks.delivery_address, delivery_tasks.recipient_name, delivery_tasks.recipient_phone, delivery_tasks.delivery_instructions, delivery_tasks.estimated_arrival_time, delivery_tasks.actual_arrival_time, delivery_tasks.delivery_time, delivery_tasks.status, delivery_tasks.failure_reason, delivery_tasks.attempt_count, delivery_tasks.created_at, delivery_tasks.updated_at,
  delivery_route.id, delivery_route.driver_id, delivery_route.route_date, delivery_route.status, delivery_route.optimized_route_data, delivery_route.total_distance_km, delivery_route.estimated_duration_minutes, delivery_route.actual_duration_minutes, delivery_route.started_at, delivery_route.completed_at, delivery_route.created_at, delivery_route.updated_at
from
  "dms"."delivery_tasks" as delivery_tasks
  inner join "dms"."delivery_routes" as delivery_route on delivery_tasks.delivery_route_id = delivery_route.id
where
  delivery_tasks.created_at >= $1::date
  and delivery_tasks.created_at <= $2::date
  and (delivery_tasks.recipient_name ilike $3::text
  or delivery_tasks.delivery_address ilike $3::text
  or delivery_tasks.status::text ilike $3::text
  or delivery_route.status::text ilike $3::text
  or $3::text is null)
`

type DmsRangeDeliveryTaskParams struct {
	Datefrom pgtype.Date
	Dateto   pgtype.Date
	Search   pgtype.Text
}

type DmsRangeDeliveryTaskRow struct {
	DmsDeliveryTask  DmsDeliveryTask
	DmsDeliveryRoute DmsDeliveryRoute
}

func (q *Queries) DmsRangeDeliveryTask(ctx context.Context, arg DmsRangeDeliveryTaskParams) ([]DmsRangeDeliveryTaskRow, error) {
	rows, err := q.db.Query(ctx, dmsRangeDeliveryTask, arg.Datefrom, arg.Dateto, arg.Search)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []DmsRangeDeliveryTaskRow
	for rows.Next() {
		var i DmsRangeDeliveryTaskRow
		if err := rows.Scan(
			&i.DmsDeliveryTask.ID,
			&i.DmsDeliveryTask.PackageID,
			&i.DmsDeliveryTask.DeliveryRouteID,
			&i.DmsDeliveryTask.RouteSequence,
			&i.DmsDeliveryTask.DeliveryAddress,
			&i.DmsDeliveryTask.RecipientName,
			&i.DmsDeliveryTask.RecipientPhone,
			&i.DmsDeliveryTask.DeliveryInstructions,
			&i.DmsDeliveryTask.EstimatedArrivalTime,
			&i.DmsDeliveryTask.ActualArrivalTime,
			&i.DmsDeliveryTask.DeliveryTime,
			&i.DmsDeliveryTask.Status,
			&i.DmsDeliveryTask.FailureReason,
			&i.DmsDeliveryTask.AttemptCount,
			&i.DmsDeliveryTask.CreatedAt,
			&i.DmsDeliveryTask.UpdatedAt,
			&i.DmsDeliveryRoute.ID,
			&i.DmsDeliveryRoute.DriverID,
			&i.DmsDeliveryRoute.RouteDate,
			&i.DmsDeliveryRoute.Status,
			&i.DmsDeliveryRoute.OptimizedRouteData,
			&i.DmsDeliveryRoute.TotalDistanceKm,
			&i.DmsDeliveryRoute.EstimatedDurationMinutes,
			&i.DmsDeliveryRoute.ActualDurationMinutes,
			&i.DmsDeliveryRoute.StartedAt,
			&i.DmsDeliveryRoute.CompletedAt,
			&i.DmsDeliveryRoute.CreatedAt,
			&i.DmsDeliveryRoute.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const dmsRemoveDeliveryTask = `-- name: DmsRemoveDeliveryTask :exec
delete from "dms"."delivery_tasks"
where id = $1::uuid
`

func (q *Queries) DmsRemoveDeliveryTask(ctx context.Context, id pgtype.UUID) error {
	_, err := q.db.Exec(ctx, dmsRemoveDeliveryTask, id)
	return err
}

const dmsUpdateDeliveryTask = `-- name: DmsUpdateDeliveryTask :one
update
  "dms"."delivery_tasks"
set
  package_id = case when $1::boolean then
    $2::uuid
  else
    package_id
  end,
  delivery_route_id = case when $3::boolean then
    $4::uuid
  else
    delivery_route_id
  end,
  route_sequence = case when $5::boolean then
    $6::integer
  else
    route_sequence
  end,
  delivery_address = case when $7::boolean then
    $8::text
  else
    delivery_address
  end,
  recipient_name = case when $9::boolean then
    $10::varchar
  else
    recipient_name
  end,
  recipient_phone = case when $11::boolean then
    $12::varchar
  else
    recipient_phone
  end,
  delivery_instructions = case when $13::boolean then
    $14::text
  else
    delivery_instructions
  end,
  estimated_arrival_time = case when $15::boolean then
    $16::timestamp
  else
    estimated_arrival_time
  end,
  actual_arrival_time = case when $17::boolean then
    $18::timestamp
  else
    actual_arrival_time
  end,
  delivery_time = case when $19::boolean then
    $20::timestamp
  else
    delivery_time
  end,
  status = case when $21::boolean then
    $22::dms.delivery_task_status_enum
  else
    status
  end,
  failure_reason = case when $23::boolean then
    $24::dms.delivery_failure_reason_enum
  else
    failure_reason
  end,
  attempt_count = case when $25::boolean then
    $26::integer
  else
    attempt_count
  end
where
  id = $27::uuid
returning
  id, package_id, delivery_route_id, route_sequence, delivery_address, recipient_name, recipient_phone, delivery_instructions, estimated_arrival_time, actual_arrival_time, delivery_time, status, failure_reason, attempt_count, created_at, updated_at
`

type DmsUpdateDeliveryTaskParams struct {
	SetPackageID            bool
	PackageID               pgtype.UUID
	SetDeliveryRouteID      bool
	DeliveryRouteID         pgtype.UUID
	SetRouteSequence        bool
	RouteSequence           int32
	SetDeliveryAddress      bool
	DeliveryAddress         string
	SetRecipientName        bool
	RecipientName           string
	SetRecipientPhone       bool
	RecipientPhone          string
	SetDeliveryInstructions bool
	DeliveryInstructions    string
	SetEstimatedArrivalTime bool
	EstimatedArrivalTime    pgtype.Timestamp
	SetActualArrivalTime    bool
	ActualArrivalTime       pgtype.Timestamp
	SetDeliveryTime         bool
	DeliveryTime            pgtype.Timestamp
	SetStatus               bool
	Status                  DmsDeliveryTaskStatusEnum
	SetFailureReason        bool
	FailureReason           DmsDeliveryFailureReasonEnum
	SetAttemptCount         bool
	AttemptCount            int32
	ID                      pgtype.UUID
}

func (q *Queries) DmsUpdateDeliveryTask(ctx context.Context, arg DmsUpdateDeliveryTaskParams) (DmsDeliveryTask, error) {
	row := q.db.QueryRow(ctx, dmsUpdateDeliveryTask,
		arg.SetPackageID,
		arg.PackageID,
		arg.SetDeliveryRouteID,
		arg.DeliveryRouteID,
		arg.SetRouteSequence,
		arg.RouteSequence,
		arg.SetDeliveryAddress,
		arg.DeliveryAddress,
		arg.SetRecipientName,
		arg.RecipientName,
		arg.SetRecipientPhone,
		arg.RecipientPhone,
		arg.SetDeliveryInstructions,
		arg.DeliveryInstructions,
		arg.SetEstimatedArrivalTime,
		arg.EstimatedArrivalTime,
		arg.SetActualArrivalTime,
		arg.ActualArrivalTime,
		arg.SetDeliveryTime,
		arg.DeliveryTime,
		arg.SetStatus,
		arg.Status,
		arg.SetFailureReason,
		arg.FailureReason,
		arg.SetAttemptCount,
		arg.AttemptCount,
		arg.ID,
	)
	var i DmsDeliveryTask
	err := row.Scan(
		&i.ID,
		&i.PackageID,
		&i.DeliveryRouteID,
		&i.RouteSequence,
		&i.DeliveryAddress,
		&i.RecipientName,
		&i.RecipientPhone,
		&i.DeliveryInstructions,
		&i.EstimatedArrivalTime,
		&i.ActualArrivalTime,
		&i.DeliveryTime,
		&i.Status,
		&i.FailureReason,
		&i.AttemptCount,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}
