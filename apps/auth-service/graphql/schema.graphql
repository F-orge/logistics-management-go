scalar UUID
scalar Timestamptz

"""
Represents a user in the system.
"""
type User {
  """
  Unique identifier for the user.
  """
  id: UUID!
  """
  The user's full name.
  """
  name: String!
  """
  The user's email address, used for login and communication.
  """
  email: String!
  """
  A boolean flag to indicate if the user has verified their email address.
  """
  emailVerified: Boolean!
  """
  A URL to the user's profile picture.
  """
  image: String
  """
  Timestamp when the user was created.
  """
  createdAt: Timestamptz!
  """
  Timestamp when the user was last updated.
  """
  updatedAt: Timestamptz!
  """
  The user's role (optional).
  """
  role: String
  """
  Boolean flag indicating if the user is banned (default: false).
  """
  banned: Boolean!
  """
  Reason for banning the user (optional).
  """
  banReason: String
  """
  Timestamp when the ban expires (optional).
  """
  banExpires: Timestamptz
  """
  Sessions associated with the user.
  """
  sessions: [Session!]!
  """
  Accounts associated with the user.
  """
  accounts: [Account!]!
}

"""
Stores session information for logged-in users.
"""
type Session {
  """
  Unique identifier for the session.
  """
  id: UUID!
  """
  The timestamp when the session expires.
  """
  expiresAt: Timestamptz!
  """
  The unique token for the session.
  """
  token: String!
  """
  Timestamp when the session was created.
  """
  createdAt: Timestamptz!
  """
  Timestamp when the session was last updated.
  """
  updatedAt: Timestamptz!
  """
  The IP address from which the session was created.
  """
  ipAddress: String
  """
  The user agent of the client.
  """
  userAgent: String
  """
  The user associated with this session.
  """
  user: User!
  """
  A foreign key referencing the user table.
  """
  userId: UUID!
  """
  The user ID of the impersonator (optional).
  """
  impersonatedBy: User
}

"""
Links a user to different authentication providers (e.g., email/password, Google, GitHub).
"""
type Account {
  """
  Unique identifier for the account.
  """
  id: UUID!
  """
  The ID of the account from the provider.
  """
  accountId: String!
  """
  The ID of the authentication provider (e.g., 'credentials', 'google').
  """
  providerId: String!
  """
  The user associated with this account.
  """
  user: User!
  """
  A foreign key referencing the user table.
  """
  userId: UUID!
  """
  The access token from the provider.
  """
  accessToken: String
  """
  The refresh token from the provider.
  """
  refreshToken: String
  """
  The ID token from the provider.
  """
  idToken: String
  """
  The expiration timestamp for the access token.
  """
  accessTokenExpiresAt: Timestamptz
  """
  The expiration timestamp for the refresh token.
  """
  refreshTokenExpiresAt: Timestamptz
  """
  The scope of permissions granted by the provider.
  """
  scope: String
  """
  The hashed password for credentials-based authentication.
  """
  password: String
  """
  Timestamp when the account was created.
  """
  createdAt: Timestamptz!
  """
  Timestamp when the account was last updated.
  """
  updatedAt: Timestamptz!
}

"""
Stores tokens for email verification or password reset.
"""
type Verification {
  """
  Unique identifier for the verification record.
  """
  id: UUID!
  """
  The identifier for the verification (e.g., email address).
  """
  identifier: String!
  """
  The verification token.
  """
  value: String!
  """
  The timestamp when the verification token expires.
  """
  expiresAt: Timestamptz!
  """
  Timestamp when the verification record was created.
  """
  createdAt: Timestamptz!
  """
  Timestamp when the verification record was last updated.
  """
  updatedAt: Timestamptz!
}

"""
Root query type for authentication-related queries.
"""
type Query {
  """
  Returns the current authenticated user.
  """
  me: User
  """
  Returns all active sessions for the current user.
  """
  activeSessions: [Session!]!
  """
  Verifies if the current session token is valid.
  """
  verifySession(token: String!): Boolean!
}

type SignInResponse {
  redirect: Boolean!
  token: String!
  user: User!
  url: String
}

type SignUpResponse {
  redirect: Boolean!
  token: String!
  user: String!
  url: String
}

type SignOutResponse {
  success: Boolean!
  message: String!
}

type RevokeSessionResponse {
  success: Boolean!
  message: String!
}

type SendEmailVerificationResponse {
  success: Boolean!
  message: String!
  expiresAt: Timestamptz!
}

type VerifyEmailResponse {
  success: Boolean!
  message: String!
  redirect: Boolean!
  url: String
}

"""
Root mutation type for authentication-related actions.
"""
type Mutation {
  """
  Register a new user with email and password.
  """
  signUp(email: String!, password: String!, name: String!): SignUpResponse!
  """
  Sign in a user using email and password. Returns a session token.
  """
  signIn(email: String!, password: String!): SignInResponse!
  """
  Sign out the current user (terminate session).
  """
  signOut(token: String!): SignOutResponse!
  """
  Revoke a specific session by ID.
  """
  revokeSession(sessionId: UUID!): RevokeSessionResponse!
  """
  Send a verification code (OTP) to the user's email address. Returns true if sent successfully.
  """
  sendEmailVerification(email: String!): SendEmailVerificationResponse!
  """
  Verify the email using the received OTP code. Marks the user's email as verified if successful.
  """
  verifyEmail(email: String!, code: String!): VerifyEmailResponse!
}
